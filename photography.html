<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Logan Rohlfs | Photography</title>
        <link rel="stylesheet" href="styles/main.css" />
    </head>
    <body class="page">
        <header class="page-hero">
            <div class="page-hero-inner">
                <div>
                    <p class="eyebrow">Portfolio</p>
                    <h1>Photography</h1>
                    <p class="lede">Selected shots and visual notes.</p>
                </div>
                <nav class="page-nav">
                    <a class="btn" href="index.html">Home</a>
                    <a class="btn" href="projects.html">Projects</a>
                    <a class="btn" href="experience.html">Experience</a>
                </nav>
            </div>
        </header>

        <main class="page-main">
            <section class="photo-section">
                <div class="section-header">
                    <h2>Gallery</h2>
                </div>
                <div class="photo-stack" id="photo-stack-page"></div>
            </section>
        </main>

        <footer>&copy; 2025 Logan Rohlfs</footer>

        <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
        <script>
            const slugFromSrc = (src) =>
                "photo-" +
                src
                    .split("/")
                    .pop()
                    .replace(/\.[^/.]+$/, "")
                    .replace(/[^a-z0-9]+/gi, "-")
                    .toLowerCase();

            const renderPhotos = (targetId) => {
                const container = document.getElementById(targetId);
                if (!container) return;
                fetch("images/photography/manifest.json")
                    .then((res) => res.json())
                    .then((items) => {
                        if (!Array.isArray(items)) return;
                        container.innerHTML = items
                            .map((item) => {
                                const slug = slugFromSrc(item.src);
                                return `
                                    <div class="photo-card" id="${slug}">
                                        <img src="${item.src}" alt="${item.caption || ""}" />
                                        ${
                                            item.caption
                                                ? `<div class="photo-caption">${item.caption}</div>`
                                                : ""
                                        }
                                    </div>
                                `;
                            })
                            .join("");
                        focusFromHash(container);
                    })
                    .catch(() => {
                        container.innerHTML =
                            "<p>Unable to load photos. Ensure manifest.json lists your images.</p>";
                    });
            };

            const focusFromHash = (container) => {
                const id = window.location.hash.slice(1);
                if (!id) return;
                const target = container.querySelector(`#${CSS.escape(id)}`);
                if (target) {
                    target.scrollIntoView({
                        behavior: "smooth",
                        block: "start",
                        inline: "nearest",
                    });
                }
            };

            window.addEventListener("hashchange", () =>
                focusFromHash(document.getElementById("photo-stack-page"))
            );

            renderPhotos("photo-stack-page");
        </script>
    </body>
</html>
